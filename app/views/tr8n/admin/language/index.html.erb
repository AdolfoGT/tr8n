<%= render :partial => "/tr8n/admin/common/header" %>
<%= render :partial => "tabs" %>
<%= tr8n_will_filter(@languages) %>

<%=link_to_function("+ Add new language", "tr8nLightbox.show('/tr8n/admin/language/lb_update', {height:350})") %>
|
<%=link_to("Calculate completeness", {:action => :calculate_total_metrics}, :confirm => "Are you sure you want to run this opperation?")%>

<%= render :partial => "/tr8n/admin/common/paginator", :locals => {:objects => @languages} %>

<table class="admin_table">
  <tr>
    <th>
      Flag
    </th>
    <th>
      Locale
    </th>
    <th>
      English Name
    </th>
    <th>
      Native Name
    </th>
    <th>
      Right to Left
    </th>
    <th style="text-align:right">
      Featured Index
    </th>
    <th style="text-align:right">
      Users
    </th>
    <th style="text-align:right">
      Translators
    </th>
    <th style="text-align:right">
      Translations
    </th>
    <th style="text-align:right">
      Completeness
    </th>
    <th></th>
  </tr>  
  <% @languages.each_with_index do |lang, index| %>
    <tr>
      <td><%=image_tag("/tr8n/images/flags/#{lang.flag}.png")%></td>
      <td>  
        <% if lang.enabled? %>
          <span style="color:green">
        <% else %>    
          <span style="color:red">
        <% end %>
            <%=lang.locale%>
          </span>
      </td>
      <td><%=link_to(lang.english_name, :action => :view, :lang_id => lang.id) %></td>
      <td><%=lang.native_name%></td>
      <td>
        <% if lang.right_to_left? %>
          <span style="color:red">
        <% else %>    
          <span style="color:green">
        <% end %>
           <%=lang.right_to_left? %>
        </span>
      </td>
      <td style="text-align:right"><%=lang.featured_index %></td>
      <td style="text-align:right">
      	<%=lang.total_metric.user_count%>
      </td>
      <td style="text-align:right">
        <%=lang.total_metric.translator_count%>
      </td>
      <td style="text-align:right">
        <%=lang.total_metric.translation_count%>
      </td>
      <td style="text-align:right">
        <% if lang.completeness == 100 %>
          <span style="color:green">
        <% else %>    
          <span style="color:red">
        <% end %>
          <%=lang.completeness ? lang.completeness : '0' %>%
        </span>
      </td>
      <td style="text-align:right">
        <%=link_to("View", :action => :view, :lang_id => lang.id) %>
				|
        <%=link_to_function("Update", "tr8nLightbox.show('/tr8n/admin/language/lb_update?lang_id=#{lang.id}', {height:350})") %>
        <% unless lang.default? %>
           |  
          <% if lang.enabled? %>
            <%=link_to("Disable", :action => :disable, :lang_id => lang.id) %>
          <% else %>
            <%=link_to("Enable", :action => :enable, :lang_id => lang.id) %>
          <% end %>
        <% end %> 
      </td>
    </tr>
  <% end %>
</table>

<%= render :partial => "/tr8n/admin/common/paginator", :locals => {:objects => @languages} %>
<%= render :partial => "/tr8n/admin/common/footer" %>
