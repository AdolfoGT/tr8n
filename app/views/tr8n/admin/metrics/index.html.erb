<%= render :partial => "/tr8n/admin/common/header" %>
<%= render :partial => "tabs" %>
<%= tr8n_will_filter(@metrics) %>

<% form_tag("", :id => "metrics_form") do %>
  <%= will_filter_table_tag(@metrics, :columns => [
    [:source_id, lambda{|metric| 
       metric.translation_source.source
    }],    
    [:language_id, lambda{|metric| 
       metric.language.english_name
    }],    
    [:key_count, lambda{|metric|
      link_to(metric.key_count, "/tr8n/admin/applications/source?mode=translation_keys&source_id=#{metric.translation_source.id}")
    }, 'text-align:right'],
    [:translated_key_count, lambda{|metric| 
      metric.translated_key_count
    }, 'padding:5px;text-align:right;white-space:nowrap;'],    
    [:locked_key_count, lambda{|metric| 
      metric.locked_key_count
    }, 'padding:5px;text-align:right;white-space:nowrap;'],    
    [:translation_count, lambda{|metric| 
      metric.translation_count
    }, 'padding:5px;text-align:right;white-space:nowrap;'],    
    [:not_translated, lambda{|metric| 
      metric.not_translated_count
    }, 'padding:5px;text-align:right;white-space:nowrap;'],    
    [:pending_approval, lambda{|metric| 
      metric.pending_approval_count
    }, 'padding:5px;text-align:right;white-space:nowrap;'],    
    [:translation_progress, lambda{|metric| 
      "#{metric.translation_completeness}%"
    }, 'padding:5px;text-align:right;white-space:nowrap;'],    
    [:locked_phrases, lambda{|metric| 
      "#{metric.completeness}%"
    }, 'padding:5px;text-align:right;white-space:nowrap;'],    
    
    [:actions, lambda{|metric|
      html = []
      html << link_to("Recalculate", {:action => :recalculate_metric, :metric_id => metric.id}, {:confirm => "Are you sure you want to recaluclate this metric?"})
      html.join(' | ')
    }, 'padding:5px;text-align:right;white-space:nowrap;']
  ]) %>
<% end %>

<%= render :partial => "/tr8n/admin/common/footer" %>
