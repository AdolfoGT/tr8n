<% form_for(:translation, @translation, :url => {:controller => "/tr8n/firefox/translator", :action => :translate}, :html => {:id => :tr8n_translator_form, :method => :post}) do |f| %>
    <%= hidden_field_tag(:translation_key_id, @translation_key.id, :id => :tr8n_translator_translation_key_id) %>
    <%= hidden_field_tag(:translation_id, @translation.id, :id => :tr8n_translator_translation_id) %>
    <%= hidden_field_tag(:source_url, @source_url, :id => :tr8n_translator_source_url) %>
    <%= hidden_field_tag(:translation_has_dependencies, "false", :id => :tr8n_translator_translation_has_dependencies) %>
    
    <div style="padding:10px;padding-bottom:0px;">
        <%= render(:partial => "translator_header")%>
      
        <div id="tr8n_translator_translation_container"> 
            <div class="strong small" style="padding-top:10px;"><%=trl("Enter #{tr8n_current_language.english_name} Translation:")%></div>
            <%= f.text_area(:label, :id => "tr8n_translator_translation_label", :class => "keyboardInput", :style=>"padding: 5px 0px; width:100%;") %>
						
		        <% if Tr8n::Config.enable_google_suggestions? %>
		        <div id="tr8n_google_suggestion_section" style="display:none; padding-top:10px;"> 
		            <div class="small_section_title" style="color: #999; font-size: 10px;">
		               <strong><%=trl("Suggested Translation")%></strong>
		            </div>
		        
		            <div id="tr8n_google_suggestion_container_<%=@translation_key.id%>" style="" class="small_section">  
		                <%=image_tag("/tr8n/images/left_quote.png", :style=>"text-align:bottom;padding-bottom:5px;") %>
		                <a onclick="Tr8n.element('tr8n_translator_translation_label').value=Tr8n.element('tr8n_translation_suggestion_<%=@translation_key.id%>').innerHTML; return false;" href="#">
		                   <span class="small" id="tr8n_translation_suggestion_<%=@translation_key.id%>" title="<%=trl("Click to insert this suggested translation above")%>"></span>
		                </a>
		                <%=image_tag("/tr8n/images/right_quote.png", :style=>"text-align:bottom;padding-top:5px;") %>
		            
		                <% sanitized_label = @translation_key.tokenless_label.gsub('"', '\"') %> 
		                <script type="text/javascript">
		                	  window.setTimeout(function() {
				              	tr8nTranslator.suggestTranslation("<%=@translation_key.id %>", "<%=sanitized_label %>", "<%=tr8n_current_language.locale%>");
							  }, 500);
		                </script>
		           </div>
		        </div>   
		        <% end %> 
        </div>
    </div> 

	<div id="tr8n_translator_buttons_container" class="buttons_container" style="width:99%; position: fixed; bottom: -100px; left:0px; z-index: 100000;">
		<div style="height:142px">
		    <button type="button" class="translator_btn translator_submit_btn" onClick="return false;" id="tr8nTranslateBtn">
		        <span><%=trl("Translate")%></span>
		    </button>
			
			<%=trl("or")%>
			
			<%=link_to_function(trl("Cancel"), "", :id => "tr8nCancelBtn")%>
		</div>
	</div>
<% end %>

<% if Tr8n::Config.enable_software_keyboard? %> 
  <script>
	window.setTimeout(function() {
    	VKI_attach(document.getElementById('tr8n_translator_translation_label'));
	}, 500);
  </script>
<% end %>

<script>
  window.setTimeout(function() {
  	Tr8n.element("tr8n_translator_translation_label").focus();	
  }, 500);		
</script>
